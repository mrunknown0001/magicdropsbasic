import{b as me,r as y,j as e,w as O,e as p,M as ge,F as D,h as b,i as v,H as B,Y as he,K as G,aK as ye,L as ee,k as S,l as E,s as ue}from"./index-C2zOcIr5.js";import{u as pe}from"./useKnowledgeBase-Bsp-TrSn.js";import{u as je}from"./useToast-BsUGRjrm.js";import{R as fe}from"./refresh-cw-BQFYSu-c.js";import{U as L}from"./upload-DWuvDsn2.js";import{S as K}from"./square-pen-Df1rf3Dp.js";const Fe=()=>{const{showToast:r}=je(),{colors:i}=me(),{categories:o,articles:d,knowledgeMetrics:j,loading:x,fetchCategories:c,fetchArticles:l,createArticle:n,updateArticle:m,getAIAnalytics:f,exportTrainingData:w,updateEffectivenessScore:a,generateEmbeddings:_}=pe(),[t,k]=y.useState("overview"),[C,A]=y.useState(null),[F,R]=y.useState(""),[P,se]=y.useState("all"),[H,U]=y.useState(!1),[J,q]=y.useState(!1),[Q,Y]=y.useState(!1),[W,te]=y.useState(""),[re,Z]=y.useState([]),[ae,X]=y.useState(!1),[ie,$]=y.useState({}),[z,M]=y.useState({});y.useEffect(()=>{c(),l(),f()},[c,l,f]),y.useEffect(()=>()=>{Object.values(z).forEach(s=>{s&&clearTimeout(s)})},[z]);const I={totalArticles:d.length,aiEnabledArticles:d.filter(s=>s.ai_training_enabled).length,highPriorityArticles:d.filter(s=>s.context_priority&&s.context_priority>=8).length,articlesWithTemplates:d.filter(s=>s.response_template).length,averageEffectiveness:d.length>0?(d.reduce((s,h)=>s+(h.ai_effectiveness_score||0),0)/d.length).toFixed(2):"0.00",totalAIUsage:d.reduce((s,h)=>s+(h.ai_usage_count||0),0)},ne=d.map(s=>({...s,...ie[s.id]})).filter(s=>{const h=!F||s.title.toLowerCase().includes(F.toLowerCase())||s.content.toLowerCase().includes(F.toLowerCase()),N=P==="all"||P==="high"&&(s.context_priority||0)>=8||P==="medium"&&(s.context_priority||0)>=4&&(s.context_priority||0)<8||P==="low"&&(s.context_priority||0)<4;return h&&N}),le=(s,h)=>{$(g=>({...g,[s]:{...g[s],context_priority:h}})),z[s]&&clearTimeout(z[s]);const N=setTimeout(async()=>{try{await m(s,{context_priority:h}),r({title:"Erfolg",message:"Priorität aktualisiert",type:"success"}),$(g=>{const u={...g};return delete u[s],u})}catch{r({title:"Fehler",message:"Fehler beim Aktualisieren der Priorität",type:"error"}),$(u=>{const T={...u};return delete T[s],T})}M(g=>{const u={...g};return delete u[s],u})},1e3);M(g=>({...g,[s]:N}))},de=(s,h)=>{$(g=>({...g,[s]:{...g[s],ai_effectiveness_score:h}})),z[`${s}_effectiveness`]&&clearTimeout(z[`${s}_effectiveness`]);const N=setTimeout(async()=>{try{await a(s,h),$(g=>{const u={...g};return u[s]&&(delete u[s].ai_effectiveness_score,Object.keys(u[s]).length===0&&delete u[s]),u})}catch{$(u=>{const T={...u};return T[s]&&(delete T[s].ai_effectiveness_score,Object.keys(T[s]).length===0&&delete T[s]),T})}M(g=>{const u={...g};return delete u[`${s}_effectiveness`],u})},1e3);M(g=>({...g,[`${s}_effectiveness`]:N}))},ce=async(s,h)=>{try{await m(s,{ai_training_enabled:h}),r({title:"Erfolg",message:`AI-Training ${h?"aktiviert":"deaktiviert"}`,type:"success"})}catch{r({title:"Fehler",message:"Fehler beim Aktualisieren der AI-Einstellung",type:"error"})}},oe=async()=>{try{Y(!0),await w()}catch{}finally{Y(!1)}},V=async s=>{try{await _(s)}catch{}},xe=async()=>{var s,h;if(!W.trim()){Z([]);return}try{X(!0);const N=await fetch("/api/ai-knowledge/search",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(s=(await ue.auth.getSession()).data.session)==null?void 0:s.access_token}`},body:JSON.stringify({query:W,limit:10,threshold:.5})});if(N.ok){const g=await N.json();Z(g.results||[]),r({title:"Semantic Search",message:`${((h=g.results)==null?void 0:h.length)||0} Artikel gefunden (${g.searchType})`,type:"success"})}else throw new Error("Search failed")}catch(N){console.error("Semantic search error:",N),r({title:"Fehler",message:"Semantic Search fehlgeschlagen",type:"error"})}finally{X(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(O,{className:"h-8 w-8 mr-3",style:{color:i.primary}}),"AI Training & Wissensdatenbank"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Verwalte die Wissensdatenbank und optimiere den AI-Assistenten"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(p,{variant:"outline",leftIcon:e.jsx(fe,{size:16}),onClick:()=>{l(),f()},children:"Aktualisieren"}),e.jsx(p,{variant:"outline",leftIcon:e.jsx(ge,{size:16}),onClick:oe,disabled:Q,children:Q?"Exportiere...":"Export"}),t==="wissensdatenbank"&&e.jsx(p,{leftIcon:e.jsx(D,{size:16}),onClick:()=>{A(null),U(!0)},style:{backgroundColor:i.primary,color:"white"},className:"hover:opacity-90 transition-opacity",children:"Artikel erstellen"}),t==="optimization"&&e.jsx(p,{variant:"outline",leftIcon:e.jsx(L,{size:16}),onClick:async()=>{try{for(const s of d.filter(h=>h.ai_training_enabled))await V(s.id);r({title:"Erfolg",message:"Alle Embeddings generiert",type:"success"})}catch{r({title:"Fehler",message:"Fehler beim Generieren der Embeddings",type:"error"})}},children:"Alle Embeddings"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(b,{children:e.jsxs(v,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mx-auto mb-3",style:{backgroundColor:`${i.primary}15`},children:e.jsx(D,{className:"h-6 w-6",style:{color:i.primary}})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:I.totalArticles}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Gesamt Artikel"})]})}),e.jsx(b,{children:e.jsxs(v,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mx-auto mb-3",style:{backgroundColor:`${i.accent}15`},children:e.jsx(O,{className:"h-6 w-6",style:{color:i.accent}})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:I.aiEnabledArticles}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"AI-Training Aktiv"})]})}),e.jsx(b,{children:e.jsxs(v,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mx-auto mb-3",style:{backgroundColor:`${i.primaryDark||i.primary}15`},children:e.jsx(B,{className:"h-6 w-6",style:{color:i.primaryDark||i.primary}})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:I.highPriorityArticles}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Hohe Priorität"})]})}),e.jsx(b,{children:e.jsxs(v,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mx-auto mb-3",style:{backgroundColor:"#8B5CF615"},children:e.jsx(he,{className:"h-6 w-6",style:{color:"#8B5CF6"}})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:I.articlesWithTemplates}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Mit Templates"})]})}),e.jsx(b,{children:e.jsxs(v,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mx-auto mb-3",style:{backgroundColor:"#F59E0B15"},children:e.jsx(G,{className:"h-6 w-6",style:{color:"#F59E0B"}})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:I.averageEffectiveness}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø Effektivität"})]})}),e.jsx(b,{children:e.jsxs(v,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mx-auto mb-3",style:{backgroundColor:"#EAB30815"},children:e.jsx(L,{className:"h-6 w-6",style:{color:"#EAB308"}})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:I.totalAIUsage}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"AI Verwendungen"})]})})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{key:"overview",label:"Übersicht",icon:e.jsx(G,{size:16})},{key:"wissensdatenbank",label:"Wissensdatenbank",icon:e.jsx(D,{size:16})},{key:"training",label:"AI Training",icon:e.jsx(O,{size:16})},{key:"analytics",label:"Analytics",icon:e.jsx(G,{size:16})},{key:"optimization",label:"Optimierung",icon:e.jsx(ye,{size:16})}].map(s=>e.jsxs("button",{onClick:()=>k(s.key),className:`
                flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm transition-colors
                ${t===s.key?"border-current dark:border-current":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}
              `,style:t===s.key?{color:i.primary,borderColor:i.primary}:{},children:[s.icon,e.jsx("span",{children:s.label})]},s.key))})}),e.jsxs("div",{className:"mt-6",children:[t==="overview"&&e.jsx(ve,{articles:ne,categories:o,colors:i,loading:x,searchTerm:F,setSearchTerm:R,priorityFilter:P,setPriorityFilter:se,onPriorityUpdate:le,onAITrainingToggle:ce,onEffectivenessUpdate:de,onEditArticle:s=>{A(s),U(!0)},onSelectArticle:A,pendingUpdates:z}),t==="wissensdatenbank"&&e.jsx(be,{articles:d,categories:o,loading:x,searchTerm:F,setSearchTerm:R,onSelectArticle:A,selectedArticle:C,onEditArticle:s=>{A(s),U(!0)}}),t==="training"&&e.jsx(ke,{articles:d,selectedArticle:C,setSelectedArticle:A,onOpenTrainingModal:()=>q(!0),onGenerateEmbeddings:V}),t==="analytics"&&e.jsx(Ne,{articles:d,metrics:j,loading:x}),t==="optimization"&&e.jsx(we,{articles:d,onOptimize:()=>{},semanticSearchQuery:W,setSemanticSearchQuery:te,semanticResults:re,isSemanticSearching:ae,onSemanticSearch:xe,onGenerateEmbeddings:V})]}),H&&e.jsx(_e,{article:C,categories:o,colors:i,isOpen:H,onClose:()=>{U(!1),A(null)},onSave:async s=>{C?await m(C.id,s):await n(s),U(!1),A(null)}}),J&&C&&e.jsx(Ce,{article:C,colors:i,isOpen:J,onClose:()=>q(!1),onSave:async s=>{await m(C.id,s),q(!1)}})]})},be=({articles:r,categories:i,loading:o,searchTerm:d,setSearchTerm:j,onSelectArticle:x,selectedArticle:c,onEditArticle:l})=>{var w;const[n,m]=y.useState("all"),f=r.filter(a=>{const _=!d||a.title.toLowerCase().includes(d.toLowerCase())||a.content.toLowerCase().includes(d.toLowerCase())||(a.summary||"").toLowerCase().includes(d.toLowerCase()),t=n==="all"||a.category_id===n;return _&&t&&a.is_published});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Wissensdatenbank durchsuchen...",value:d,onChange:a=>j(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),e.jsxs("select",{value:n,onChange:a=>m(a.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"all",children:"Alle Kategorien"}),i.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(b,{children:[e.jsx(S,{children:e.jsxs(E,{className:"flex items-center",children:[e.jsx(D,{className:"h-5 w-5 mr-2"}),"Artikel (",f.length,")"]})}),e.jsx(v,{children:o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ee,{size:"lg"})}):e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[f.map(a=>e.jsx("div",{onClick:()=>x(a),className:`
                        p-4 rounded-lg border cursor-pointer transition-colors
                        ${(c==null?void 0:c.id)===a.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-800"}
                      `,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:a.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 line-clamp-2",children:a.summary||a.content.substring(0,100)+"..."}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["Aufrufe: ",a.view_count]}),e.jsxs("span",{children:["Hilfreich: ",a.helpful_votes]}),a.ai_training_enabled&&e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"AI Training"})]})]}),e.jsx("div",{className:"flex items-center space-x-1 ml-3",children:e.jsx(p,{size:"sm",variant:"outline",leftIcon:e.jsx(K,{size:12}),onClick:_=>{_.stopPropagation(),l(a)},children:"Bearbeiten"})})]})},a.id)),f.length===0&&!o&&e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"Keine Artikel gefunden"})]})})]})}),e.jsx("div",{children:e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(E,{children:"Artikel-Vorschau"})}),e.jsx(v,{children:c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:c.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:c.summary})]}),e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg max-h-64 overflow-y-auto",children:e.jsxs("pre",{className:"whitespace-pre-wrap text-sm",children:[c.content.substring(0,500),c.content.length>500&&"..."]})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Kategorie:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white ml-2",children:((w=c.category)==null?void 0:w.name)||"Unbekannt"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-medium ml-2 ${c.is_published?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-400"}`,children:c.is_published?"Veröffentlicht":"Entwurf"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"AI Priorität:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white ml-2",children:[c.context_priority||5,"/10"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"AI Nutzung:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white ml-2",children:[c.ai_usage_count||0,"x"]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(p,{leftIcon:e.jsx(K,{size:16}),onClick:()=>l(c),className:"w-full",children:"Artikel bearbeiten"})})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"Wähle einen Artikel zur Vorschau"})})]})})]})]})},ve=({articles:r,categories:i,colors:o,loading:d,searchTerm:j,setSearchTerm:x,priorityFilter:c,setPriorityFilter:l,onPriorityUpdate:n,onAITrainingToggle:m,onEffectivenessUpdate:f,onEditArticle:w,onSelectArticle:a,pendingUpdates:_})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Artikel durchsuchen...",value:j,onChange:t=>x(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),e.jsxs("select",{value:c,onChange:t=>l(t.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"all",children:"Alle Prioritäten"}),e.jsx("option",{value:"high",children:"Hoch (8-10)"}),e.jsx("option",{value:"medium",children:"Mittel (4-7)"}),e.jsx("option",{value:"low",children:"Niedrig (1-3)"})]})]}),d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ee,{size:"lg"})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:r.map(t=>e.jsxs(b,{className:"h-full",children:[e.jsx(S,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(E,{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx("span",{className:`
                        inline-flex items-center px-2 py-1 rounded-full text-xs font-medium
                        ${t.is_published?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}
                      `,children:t.is_published?"Veröffentlicht":"Entwurf"}),t.ai_training_enabled&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200",children:[e.jsx(O,{size:12,className:"mr-1"}),"AI Training"]})]})]})})}),e.jsxs(v,{className:"pt-0",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-3",children:t.summary||t.content.substring(0,150)+"..."}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Kontext-Priorität:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"range",min:"1",max:"10",value:t.context_priority||5,onChange:k=>n(t.id,parseInt(k.target.value)),className:"w-16 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, ${o.primary} 0%, ${o.primary} ${(t.context_priority||5)/10*100}%, #e5e7eb ${(t.context_priority||5)/10*100}%, #e5e7eb 100%)`}}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white w-6",children:[t.context_priority||5,_[t.id]&&e.jsx("span",{className:"text-xs text-yellow-600 ml-1",children:"●"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"AI Effektivität:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"range",min:"0",max:"10",step:"0.1",value:t.ai_effectiveness_score||0,onChange:k=>f(t.id,parseFloat(k.target.value)),className:"w-16 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, ${o.accent} 0%, ${o.accent} ${(t.ai_effectiveness_score||0)/10*100}%, #e5e7eb ${(t.ai_effectiveness_score||0)/10*100}%, #e5e7eb 100%)`}}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white w-8",children:[(t.ai_effectiveness_score||0).toFixed(1),_[`${t.id}_effectiveness`]&&e.jsx("span",{className:"text-xs text-yellow-600 ml-1",children:"●"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"AI Verwendungen:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.ai_usage_count||0})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"AI Training"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.ai_training_enabled??!0,onChange:k=>m(t.id,k.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 ${t.ai_training_enabled,"bg-gray-200 peer-focus:ring-4"}`,style:t.ai_training_enabled?{backgroundColor:o.primary,boxShadow:`0 0 0 4px ${o.primary}20`}:{}})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{size:"sm",variant:"outline",leftIcon:e.jsx(D,{size:14}),onClick:()=>a(t),className:"flex-1",children:"Details"}),e.jsx(p,{size:"sm",variant:"outline",leftIcon:e.jsx(K,{size:14}),onClick:()=>w(t),children:"Bearbeiten"})]})]})]},t.id))})]}),ke=({articles:r,selectedArticle:i,setSelectedArticle:o,onOpenTrainingModal:d,onGenerateEmbeddings:j})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(E,{children:"AI Training Artikel"})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:r.filter(x=>x.ai_training_enabled).map(x=>e.jsxs("button",{onClick:()=>o(x),className:`
                  w-full text-left p-3 rounded-lg border transition-colors
                  ${(i==null?void 0:i.id)===x.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-800"}
                `,children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:x.title}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Priorität: ",x.context_priority||5,"/10"]})]},x.id))})})]}),e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(E,{children:"Training Details"})}),e.jsx(v,{children:i?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:i.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:i.summary})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Priorität:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white ml-2",children:[i.context_priority||5,"/10"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Effektivität:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white ml-2",children:[(i.ai_effectiveness_score||0).toFixed(1),"/10"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Verwendungen:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white ml-2",children:i.ai_usage_count||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Letzte Nutzung:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white ml-2",children:i.last_ai_usage?new Date(i.last_ai_usage).toLocaleDateString("de-DE"):"Nie"})]})]}),i.response_template&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Response Template:"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg text-sm",children:i.response_template})]}),e.jsxs("div",{className:"pt-4 space-x-2",children:[e.jsx(p,{leftIcon:e.jsx(K,{size:16}),onClick:d,children:"Training bearbeiten"}),e.jsx(p,{variant:"outline",leftIcon:e.jsx(L,{size:16}),onClick:()=>i&&j(i.id),children:"Embeddings generieren"})]})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"Wähle einen Artikel für Training-Details"})})]})]}),Ne=({articles:r,metrics:i,loading:o})=>e.jsx("div",{className:"space-y-6",children:e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(E,{children:"AI Performance Analytics"})}),e.jsx(v,{children:e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"Analytics Dashboard wird implementiert..."})})]})}),we=({articles:r,onOptimize:i,semanticSearchQuery:o,setSemanticSearchQuery:d,semanticResults:j,isSemanticSearching:x,onSemanticSearch:c,onGenerateEmbeddings:l})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{children:[e.jsx(S,{children:e.jsxs(E,{className:"flex items-center",children:[e.jsx(B,{className:"h-5 w-5 mr-2"}),"Semantic Search Tester"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Teste semantische Suche... (z.B. 'Probleme mit Upload')",value:o,onChange:n=>d(n.target.value),onKeyDown:n=>n.key==="Enter"&&c(),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})}),e.jsx(p,{onClick:c,disabled:x||!o.trim(),leftIcon:e.jsx(B,{size:16}),children:x?"Suche...":"Suchen"})]}),j.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:["Suchergebnisse (",j.length,")"]}),e.jsx("div",{className:"space-y-2",children:j.map(n=>{var m;return e.jsx("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 dark:text-white",children:n.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:n.summary||((m=n.content)==null?void 0:m.substring(0,100))+"..."}),n.similarity_score&&e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Relevanz: ",(n.similarity_score*100).toFixed(1),"%"]})]})})},n.id)})})]})]})})]}),e.jsxs(b,{children:[e.jsx(S,{children:e.jsxs(E,{className:"flex items-center",children:[e.jsx(L,{className:"h-5 w-5 mr-2"}),"Embeddings Verwaltung"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Generiere Embeddings für bessere semantische Suche und AI-Performance."}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:r.filter(n=>n.ai_training_enabled).map(n=>e.jsx("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:n.title}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Priorität: ",n.context_priority||5,"/10"]})]}),e.jsx(p,{size:"sm",variant:"outline",leftIcon:e.jsx(L,{size:14}),onClick:()=>l(n.id),children:"Embeddings"})]})},n.id))})]})})]}),e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(E,{children:"AI Optimierung"})}),e.jsx(v,{children:e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"Erweiterte Optimierungs-Tools werden implementiert..."})})]})]}),_e=({article:r,categories:i,colors:o,isOpen:d,onClose:j,onSave:x})=>{const c=!r,[l,n]=y.useState({title:(r==null?void 0:r.title)||"",summary:(r==null?void 0:r.summary)||"",content:(r==null?void 0:r.content)||"",context_priority:(r==null?void 0:r.context_priority)||5,response_template:(r==null?void 0:r.response_template)||"",category_id:(r==null?void 0:r.category_id)||"",is_published:(r==null?void 0:r.is_published)??!0,ai_training_enabled:(r==null?void 0:r.ai_training_enabled)??!0}),[m,f]=y.useState(!1),w=async()=>{if(c){if(!l.title.trim()){alert("Titel ist erforderlich");return}if(!l.content.trim()){alert("Inhalt ist erforderlich");return}if(!l.category_id){alert("Kategorie ist erforderlich");return}}try{f(!0),await x(l)}finally{f(!1)}};return d?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:c?"Artikel erstellen":"Artikel bearbeiten"}),e.jsx("button",{onClick:j,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:"✕"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Titel"}),e.jsx("input",{type:"text",value:l.title,onChange:a=>n({...l,title:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white",style:{"--tw-ring-color":`${o.primary}50`}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zusammenfassung"}),e.jsx("textarea",{value:l.summary,onChange:a=>n({...l,summary:a.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white",style:{"--tw-ring-color":`${o.primary}50`}})]}),c&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Kategorie"}),e.jsxs("select",{value:l.category_id,onChange:a=>n({...l,category_id:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white",style:{"--tw-ring-color":`${o.primary}50`},required:!0,children:[e.jsx("option",{value:"",children:"Kategorie wählen..."}),i.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Inhalt"}),e.jsx("textarea",{value:l.content,onChange:a=>n({...l,content:a.target.value}),rows:8,placeholder:"Artikel-Inhalt in Markdown...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white",style:{"--tw-ring-color":`${o.primary}50`},required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Kontext-Priorität: ",l.context_priority]}),e.jsx("input",{type:"range",min:"1",max:"10",value:l.context_priority,onChange:a=>n({...l,context_priority:parseInt(a.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, ${o.primary} 0%, ${o.primary} ${l.context_priority/10*100}%, #e5e7eb ${l.context_priority/10*100}%, #e5e7eb 100%)`}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Response Template"}),e.jsx("textarea",{value:l.response_template,onChange:a=>n({...l,response_template:a.target.value}),rows:4,placeholder:"Vordefinierte Antwort für AI...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white",style:{"--tw-ring-color":`${o.primary}50`}})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6",children:[e.jsx(p,{variant:"outline",onClick:j,disabled:m,children:"Abbrechen"}),e.jsx(p,{onClick:w,disabled:m,style:{backgroundColor:o.primary,color:"white"},className:"hover:opacity-90 transition-opacity",children:m?c?"Erstelle...":"Speichere...":c?"Erstellen":"Speichern"})]})]})})}):null},Ce=({article:r,colors:i,isOpen:o,onClose:d,onSave:j})=>{const[x,c]=y.useState({conversation_examples:r.conversation_examples||[]}),[l,n]=y.useState(!1),[m,f]=y.useState({question:"",answer:""}),w=async()=>{try{n(!0),await j(x)}finally{n(!1)}},a=()=>{m.question.trim()&&m.answer.trim()&&(c({...x,conversation_examples:[...x.conversation_examples,{...m,id:Date.now()}]}),f({question:"",answer:""}))},_=t=>{c({...x,conversation_examples:x.conversation_examples.filter((k,C)=>C!==t)})};return o?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["AI Training bearbeiten: ",r.title]}),e.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:"✕"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:["Training-Beispiele (",x.conversation_examples.length,")"]}),x.conversation_examples.map((t,k)=>e.jsx("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 mb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Frage:"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.question})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Antwort:"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.answer})]})]}),e.jsx("button",{onClick:()=>_(k),className:"text-red-500 hover:text-red-700 ml-3",children:e.jsx(O,{size:16})})]})},k))]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-600 pt-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Neues Beispiel hinzufügen"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Frage"}),e.jsx("input",{type:"text",value:m.question,onChange:t=>f({...m,question:t.target.value}),placeholder:"Beispielfrage...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white",style:{"--tw-ring-color":`${i.primary}50`}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Erwartete Antwort"}),e.jsx("textarea",{value:m.answer,onChange:t=>f({...m,answer:t.target.value}),placeholder:"Erwartete AI-Antwort...",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white",style:{"--tw-ring-color":`${i.primary}50`}})]}),e.jsx(p,{onClick:a,disabled:!m.question.trim()||!m.answer.trim(),size:"sm",style:{backgroundColor:i.accent,color:"white"},className:"hover:opacity-90 transition-opacity",children:"Beispiel hinzufügen"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6",children:[e.jsx(p,{variant:"outline",onClick:d,disabled:l,children:"Abbrechen"}),e.jsx(p,{onClick:w,disabled:l,style:{backgroundColor:i.primary,color:"white"},className:"hover:opacity-90 transition-opacity",children:l?"Speichere...":"Speichern"})]})]})})}):null};export{Fe as default};
