import{b as D,r as E,j as e,h as u,k as b,i as h,l as w,o as x,f,K as y,m as d,F,V as M,p as U,A as g,N as v,_ as W,O as K}from"./index-C2zOcIr5.js";import{S as o}from"./ShimmerEffect-By9i5EVD.js";import{U as _}from"./upload-DWuvDsn2.js";import{R}from"./refresh-cw-BQFYSu-c.js";const k={pending:{label:"Ausstehend",bg:"bg-yellow-100",text:"text-yellow-800",icon:f,darkBg:"dark:bg-yellow-300",darkText:"dark:text-yellow-900"},submitted:{label:"Eingereicht - Warten auf Prüfung",bg:"bg-blue-100",text:"text-blue-800",icon:_,darkBg:"dark:bg-blue-300",darkText:"dark:text-blue-900"},completed:{label:"Abgeschlossen",bg:"bg-green-100",text:"text-green-800",icon:y,darkBg:"dark:bg-green-300",darkText:"dark:text-green-900"},rejected:{label:"Abgelehnt",bg:"bg-red-100",text:"text-red-800",icon:f,darkBg:"dark:bg-red-300",darkText:"dark:text-red-900"},canceled:{label:"Storniert",bg:"bg-gray-100",text:"text-gray-800",icon:x,darkBg:"dark:bg-gray-300",darkText:"dark:text-gray-900"}},P=({taskAssignment:r,isLoading:C=!1,onStartTask:B,onRestartTask:p})=>{const{settings:l}=D(),{isTaskBasedUser:$}=useAuth(),a=(l==null?void 0:l.primary_color)||"#ee1d3c";l!=null&&l.accent_color;const[i,j]=E.useState(!1);if(C)return e.jsxs(u,{className:"w-full h-full shadow-md border border-gray-100 dark:border-gray-800",children:[e.jsx(b,{children:e.jsx(o,{className:"h-8 w-3/4 mb-2"})}),e.jsxs(h,{children:[e.jsx(o,{className:"h-4 w-full mb-4"}),e.jsx(o,{className:"h-4 w-full mb-4"}),e.jsx(o,{className:"h-4 w-1/2 mb-4"})]})]});if(!r||!r.task_template)return e.jsxs(u,{className:"w-full h-full shadow-md border border-gray-100 dark:border-gray-800",children:[e.jsx(b,{children:e.jsx(w,{children:"Keine Aufgabe ausgewählt"})}),e.jsx(h,{children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Bitte wähle eine Aufgabe aus der Liste aus."})})]});const{task_template:s}=r,c=k[r.status]||k.pending,S=c.icon,m=n=>{try{return W(new Date(n),"dd. MMMM yyyy",{locale:K})}catch{return"Ungültiges Datum"}},z=n=>{switch(n){case"not_started":return"bg-yellow-400";case"accepted":return"bg-green-500";case"completed":return"bg-blue-500";case"declined":return"bg-red-500";default:return"bg-gray-400"}},N=()=>{i||(j(!0),B(),setTimeout(()=>{j(!1)},2e3))},T=r.status==="pending"&&(r.video_chat_status==="not_started"||!r.video_chat_status),V=r.status==="pending"&&r.video_chat_status==="accepted",I=r.status==="rejected"&&p;return e.jsx(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(u,{className:"w-full h-full overflow-auto shadow-md border border-gray-100 dark:border-gray-800",children:[e.jsx(b,{className:"flex flex-col space-y-3 pb-4 border-b border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(w,{className:"text-xl font-bold mb-1",children:s.title}),r.task_template_id&&e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Aufgaben-ID: ",r.task_template_id.substring(0,8)]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${c.bg} ${c.text} ${c.darkBg} ${c.darkText}`,children:[e.jsx(S,{size:12,className:"mr-1"}),c.label]}),r.due_date&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:[e.jsx(x,{size:12,className:"mr-1"}),"Fällig: ",m(r.due_date)]})]})]})}),e.jsx(h,{className:"pt-6 pb-6",children:e.jsxs("div",{className:"space-y-6",children:[(r.status==="submitted"||r.status==="rejected")&&e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Status der Einreichung"}),e.jsx("div",{className:`rounded-lg p-5 shadow-sm border ${r.status==="submitted"?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:`flex-shrink-0 rounded-full w-10 h-10 flex items-center justify-center mr-4 ${r.status==="submitted"?"bg-blue-100 dark:bg-blue-800":"bg-red-100 dark:bg-red-800"}`,children:r.status==="submitted"?e.jsx(_,{size:20,className:"text-blue-600 dark:text-blue-400"}):e.jsx(f,{size:20,className:"text-red-600 dark:text-red-400"})}),e.jsx("div",{className:"flex-1",children:r.status==="submitted"?e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-blue-800 dark:text-blue-200 mb-2",children:"Aufgabe eingereicht"}),e.jsx("p",{className:"text-base text-blue-600 dark:text-blue-300 mb-2",children:"Ihre Aufgabe wurde erfolgreich eingereicht und wird nun von einem Administrator geprüft."}),r.submitted_at&&e.jsxs("p",{className:"text-sm text-blue-500 dark:text-blue-400",children:["Eingereicht am: ",m(r.submitted_at)]})]}):e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-red-800 dark:text-red-200 mb-2",children:"Aufgabe abgelehnt"}),e.jsx("p",{className:"text-base text-red-600 dark:text-red-300 mb-3",children:"Ihre Aufgabe wurde vom Administrator abgelehnt. Bitte beachten Sie den unten stehenden Grund und starten Sie die Aufgabe neu."}),r.rejection_reason&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-md border border-red-200 dark:border-red-700 mb-3",children:[e.jsx("h5",{className:"font-medium text-red-800 dark:text-red-200 mb-2",children:"Ablehnungsgrund:"}),e.jsx("p",{className:"text-red-700 dark:text-red-300",children:r.rejection_reason})]}),r.admin_notes&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-md border border-red-200 dark:border-red-700 mb-3",children:[e.jsx("h5",{className:"font-medium text-red-800 dark:text-red-200 mb-2",children:"Hinweise des Administrators:"}),e.jsx("p",{className:"text-red-700 dark:text-red-300",children:r.admin_notes})]}),r.reviewed_at&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400",children:["Abgelehnt am: ",m(r.reviewed_at)]})]})})]})})]}),e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:"w-full mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Aufgabenbeschreibung"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-5 shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 rounded-full w-10 h-10 flex items-center justify-center mr-4",style:{backgroundColor:`${a}20`},children:e.jsx(F,{size:20,style:{color:a}})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-base text-gray-700 dark:text-gray-300 whitespace-pre-wrap leading-relaxed",children:s.description||"Keine Beschreibung vorhanden."})})]})})]}),$()&&e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.15},className:"w-full",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Vergütung"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-5 shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 rounded-full w-10 h-10 flex items-center justify-center mr-4 bg-emerald-100 dark:bg-emerald-900/30",children:e.jsx("span",{className:"text-emerald-600 dark:text-emerald-400 font-bold",children:"€"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["€",(r.custom_payment_amount||s.payment_amount||0).toFixed(2)]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.custom_payment_amount?"Individuelle Vergütung":"Standard-Vergütung"})]}),r.status==="completed"&&e.jsx("div",{className:"flex items-center space-x-2",children:r.payment_status==="approved"?e.jsxs("div",{className:"flex items-center text-emerald-600 dark:text-emerald-400",children:[e.jsx(y,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:"Genehmigt"})]}):r.payment_status==="pending"?e.jsxs("div",{className:"flex items-center text-yellow-600 dark:text-yellow-400",children:[e.jsx(x,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:"Ausstehend"})]}):e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[e.jsx(x,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:"Wird geprüft"})]})})]})})]})})]}),s.steps&&s.steps.length>0&&e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"w-full",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Aufgabenverlauf"}),e.jsx("div",{className:"w-full overflow-hidden",children:s.steps.map((n,t)=>e.jsx(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2+t*.1},className:`mb-4 rounded-lg overflow-hidden shadow-sm border ${t<s.steps.length-1,""} ${r.current_step>t?"border-green-200 dark:border-green-800":r.current_step===t?`border-2 border-${a.replace("#","")} dark:border-${a.replace("#","")}`:"border-gray-200 dark:border-gray-700"}`,children:e.jsx("div",{className:`w-full p-5 ${r.current_step>t?"bg-green-50 dark:bg-green-900/20":r.current_step===t?"bg-blue-50 dark:bg-blue-900/20":"bg-white dark:bg-gray-800"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:`flex-shrink-0 rounded-full w-8 h-8 flex items-center justify-center mr-4 ${r.current_step>t?"bg-green-100 dark:bg-green-800":r.current_step===t?`bg-${a.replace("#","")}/10 dark:bg-${a.replace("#","")}/30`:"bg-gray-100 dark:bg-gray-700"}`,style:r.current_step===t?{backgroundColor:`${a}20`}:{},children:r.current_step>t?e.jsx(y,{size:18,className:"text-green-600 dark:text-green-400"}):e.jsx("span",{className:"text-base font-semibold",children:t+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-800 dark:text-gray-100 mb-2",children:n.title}),e.jsx("p",{className:"text-base text-gray-600 dark:text-gray-400",children:n.description})]})]})})},t))})]}),r.video_chat_status&&e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},className:"w-full",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Video-Chat Status"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-5 flex items-center shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex-shrink-0 rounded-full w-10 h-10 flex items-center justify-center mr-4",style:{backgroundColor:`${a}20`},children:e.jsx(M,{size:20,style:{color:a}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-800 dark:text-gray-100",children:"Video Beratung"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:`h-2.5 w-2.5 rounded-full mr-2 ${z(r.video_chat_status)}`}),e.jsxs("p",{className:"text-base text-gray-600 dark:text-gray-400",children:[r.video_chat_status==="not_started"&&"Noch nicht gestartet",r.video_chat_status==="accepted"&&"Akzeptiert - Bereit für Beratung",r.video_chat_status==="completed"&&"Abgeschlossen",r.video_chat_status==="declined"&&"Abgelehnt"]})]})]})]})]})]})}),e.jsxs(U,{className:"flex flex-col sm:flex-row justify-start space-y-3 sm:space-y-0 sm:space-x-3 pt-0 border-t border-gray-100 dark:border-gray-800 px-6 py-6",children:[T&&e.jsx(g,{onClick:N,disabled:i,className:"w-full sm:w-auto text-xl font-bold px-12 py-4 whitespace-nowrap min-w-[280px]",style:{backgroundColor:a,color:"white"},children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("span",{className:"font-bold",children:i?"Wird gestartet...":"Aufgabe starten"}),e.jsx(v,{className:"rotate-270",size:20})]})}),V&&e.jsx(g,{onClick:N,disabled:i,className:"w-full sm:w-auto text-xl font-bold px-12 py-4 whitespace-nowrap min-w-[280px]",style:{backgroundColor:a,color:"white"},children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("span",{className:"font-bold",children:i?"Wird fortgesetzt...":"Aufgabe fortsetzen"}),e.jsx(v,{className:"rotate-270",size:20})]})}),I&&e.jsx(g,{onClick:p,disabled:i,className:"w-full sm:w-auto text-base font-medium px-8 py-2 whitespace-nowrap bg-red-600 hover:bg-red-700 text-white min-w-[180px]",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(R,{size:16}),e.jsx("span",{className:"font-medium",children:"Aufgabe neu starten"})]})})]})]})})};export{P as T};
