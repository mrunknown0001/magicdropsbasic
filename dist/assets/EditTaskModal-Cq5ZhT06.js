import{t as k,r as d,j as e,v as D,m as h,X as I,I as f,a2 as o,e as j}from"./index-C2zOcIr5.js";import{u as z}from"./useEmployees-BfxrKmlR.js";const F=({isOpen:v,onClose:c,onSubmit:w,task:t,isLoading:l})=>{var m,b,p,x,y;const{register:a,handleSubmit:N,formState:{errors:i},reset:u}=k(),{employees:g,loading:_}=z(),[S,E]=d.useState([]);d.useEffect(()=>{const r=g.filter(s=>!s.banned_until||new Date(s.banned_until)<=new Date).map(s=>({value:s.id,label:s.name||s.email||s.id}));E(r)},[g]),d.useEffect(()=>{t&&u({title:t.title,description:t.description||"",status:t.status,priority:t.priority,assignee_id:t.assignee_id||"",due_date:t.due_date?new Date(t.due_date).toISOString().split("T")[0]:""})},[t,u]);const A=async r=>{if(t)try{const s={...r,due_date:r.due_date?new Date(r.due_date).toISOString():null};await w(t.id,s),c()}catch{}},n=()=>{l||c()};return t?e.jsx(D,{children:v&&e.jsxs(e.Fragment,{children:[e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:n}),e.jsx(h.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-0",onClick:r=>r.stopPropagation(),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Aufgabe bearbeiten"}),e.jsx("button",{onClick:n,disabled:l,className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:e.jsx(I,{size:20})})]}),e.jsxs("form",{onSubmit:N(A),children:[e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(f,{label:"Titel",...a("title",{required:"Titel ist erforderlich"}),error:(m=i.title)==null?void 0:m.message,placeholder:"Aufgabentitel eingeben"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Beschreibung"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-accent focus:border-accent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:4,placeholder:"Beschreibung der Aufgabe",...a("description")}),i.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.description.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(o,{label:"Status",...a("status",{required:"Status ist erforderlich"}),error:(b=i.status)==null?void 0:b.message,options:[{value:"pending",label:"Ausstehend"},{value:"in_progress",label:"In Bearbeitung"},{value:"completed",label:"Abgeschlossen"}]}),e.jsx(o,{label:"Priorität",...a("priority",{required:"Priorität ist erforderlich"}),error:(p=i.priority)==null?void 0:p.message,options:[{value:"low",label:"Niedrig"},{value:"medium",label:"Mittel"},{value:"high",label:"Hoch"}]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(o,{label:"Zugewiesen an",...a("assignee_id"),error:(x=i.assignee_id)==null?void 0:x.message,options:[{value:"",label:"Nicht zugewiesen"},...S],isLoading:_}),e.jsx(f,{label:"Fälligkeitsdatum",type:"date",...a("due_date"),error:(y=i.due_date)==null?void 0:y.message})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end space-x-3",children:[e.jsx(j,{type:"button",variant:"outline",onClick:n,disabled:l,children:"Abbrechen"}),e.jsx(j,{type:"submit",isLoading:l,children:"Speichern"})]})]})]})})]})}):null};export{F as E};
