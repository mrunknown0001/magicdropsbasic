const u=(t,c={})=>{if(!t||!t.content)return"";let e=t.content;if(/<\/?[a-z][\s\S]*>/i.test(e))try{const s=new DOMParser().parseFromString(e,"text/html"),n={date:new Date().toLocaleDateString("de-DE"),startdatum:new Date().toLocaleDateString("de-DE"),datum:new Date().toLocaleDateString("de-DE"),unterschriftsdatum:new Date().toLocaleDateString("de-DE"),...t.template_data||{},...c},r=o=>{if(o.nodeType===Node.TEXT_NODE&&o.textContent){const f=/{{(.*?)}}/g;let i=o.textContent,d;for(;(d=f.exec(o.textContent))!==null;){const m=d[1].trim(),g=n[m];if(g!==void 0){const E=p(g,m);i=i.replace(d[0],E)}else i=i.replace(d[0],"")}i!==o.textContent&&(o.textContent=i)}else o.nodeType===Node.ELEMENT_NODE&&Array.from(o.childNodes).forEach(f=>{r(f)})};r(s.body),e=s.body.innerHTML}catch(a){console.error("Error processing HTML content:",a)}else{e=e.replace(/[─━┅┉═]{2,}/g,"──────────────────").replace(/%{2,}/g,"──────────────────");const a=new Date().toLocaleDateString("de-DE"),s={date:a,startdatum:a,datum:a,unterschriftsdatum:a};t.template_data&&typeof t.template_data=="object"&&Object.entries(t.template_data).forEach(([n,r])=>{if(r==null)return;const o=p(r,n);e=e.replace(new RegExp(`{{${n}}}`,"gi"),o)}),Object.entries(c).forEach(([n,r])=>{if(r==null)return;const o=p(r,n);e=e.replace(new RegExp(`{{${n}}}`,"gi"),o)}),Object.entries(s).forEach(([n,r])=>{e=e.replace(new RegExp(`{{${n}}}`,"gi"),String(r))}),e=e.replace(/{{.*?}}/g,""),e=e.replace(/\n\s*\n/g,`

`)}return e},D=t=>{if(!t)return[];const c=new Set;try{const l=new DOMParser().parseFromString(t,"text/html"),a=s=>{if(s.nodeType===Node.TEXT_NODE&&s.textContent){const n=/{{(.*?)}}/g;let r;for(;(r=n.exec(s.textContent))!==null;)r[1]&&r[1].trim()&&c.add(r[1].trim())}else s.nodeType===Node.ELEMENT_NODE&&s.childNodes.forEach(n=>{a(n)})};a(l.body)}catch{const l=/{{(.*?)}}/g;let a;for(;(a=l.exec(t))!==null;)a[1]&&a[1].trim()&&c.add(a[1].trim())}return Array.from(c)},p=(t,c)=>{if(t==null)return"";if(c.toLowerCase().includes("date")||c.toLowerCase().includes("datum"))try{const e=new Date(t);if(!isNaN(e.getTime()))return e.toLocaleDateString("de-DE")}catch{}if(typeof t=="object"&&t!==null)try{return JSON.stringify(t)}catch{}return String(t)};export{D as e,u as p};
