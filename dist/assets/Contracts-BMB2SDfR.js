import{U as A,r as s,u as L,G as D,b as T,j as e,m as n,at as o,e as u,au as p,a5 as I,h as b,i as f,A as B,a8 as M,ab as K,ac as O,av as $,O as R}from"./index-C2zOcIr5.js";import{S as j}from"./ShimmerEffect-By9i5EVD.js";import{u as G,V as P}from"./ViewContractModal-Cn0OQcpx.js";import{u as U}from"./useToast-BsUGRjrm.js";import{f as Z}from"./formatDistanceToNow-Zog-F_3p.js";import"./contractUtils-B5S0O9Tf.js";const q=()=>{const[d,H]=s.useState(""),[c,J]=s.useState(""),[v,x]=s.useState(!1),[m,k]=s.useState(null),[Q,g]=s.useState(!1),{showToast:a}=U(),{isAdmin:w}=L(),h=D(),{colors:N}=T(),{contracts:i,loading:l,error:C,fetchContracts:S,createContract:V,deleteContract:z}=G();i.filter(t=>{if(!t||!t.title||!t.category||!t.id)return!1;const r=t.title.toLowerCase().includes(d.toLowerCase())||t.category.toLowerCase().includes(d.toLowerCase())||t.id.toLowerCase().includes(d.toLowerCase()),_=!c||t.category===c;return r&&_}),[...new Set(i.map(t=>t.category))].sort();const y=()=>{S(!0),a({type:"info",title:"Verträge werden neu geladen",message:"Bitte warten Sie einen Moment..."})},F=async t=>{if(window.confirm("Sind Sie sicher, dass Sie diese Vertragsvorlage löschen möchten?"))try{await z(t),a({title:"Erfolg",message:"Vertragsvorlage wurde erfolgreich gelöscht.",type:"success"})}catch{a({title:"Fehler",message:"Die Vertragsvorlage konnte nicht gelöscht werden.",type:"error"})}},E=async t=>{try{g(!0);const r={...t,title:`${t.title} (Kopie)`,is_template:!0,created_by:t.created_by};delete r.id,delete r.created_at,delete r.updated_at,await V(r),a({title:"Erfolg",message:"Vertragsvorlage wurde erfolgreich dupliziert.",type:"success"})}catch{a({title:"Fehler",message:"Die Vertragsvorlage konnte nicht dupliziert werden.",type:"error"})}finally{g(!1)}};return e.jsxs("div",{className:"w-full px-4 py-6",children:[e.jsx(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(o,{size:24,className:"text-gray-900 dark:text-white mr-4"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-app font-app-bold text-gray-900 dark:text-white flex items-center",children:["Vertragsvorlagen",l&&e.jsx("span",{className:"ml-3 inline-block",children:e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-indigo-500 dark:border-white border-t-transparent dark:border-t-transparent rounded-full"})})]}),e.jsx("p",{className:"mt-1 text-gray-600 dark:text-gray-400 font-app",children:"Verwalten Sie Ihre Vertragsvorlagen für Kunden und Mitarbeiter"})]})]}),e.jsxs("div",{className:"mt-4 md:mt-0 flex items-center space-x-3",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:y,disabled:l,leftIcon:e.jsx(p,{size:16}),children:"Aktualisieren"}),e.jsx(u,{size:"md",onClick:()=>h("/admin/contracts/create"),leftIcon:e.jsx(I,{size:16}),style:{backgroundColor:N.primary,color:"white"},className:"hover:opacity-90 transition-opacity",children:"Neue Vorlage"})]})]})}),l?e.jsx(b,{children:e.jsx(f,{className:"py-10",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(j,{className:"h-8 w-full max-w-md"}),e.jsx(j,{className:"h-64 w-full"})]})})}):C?e.jsx(b,{children:e.jsx(f,{className:"py-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Fehler beim Laden der Verträge"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Es ist ein Fehler aufgetreten. Bitte versuchen Sie es später erneut."}),e.jsx(B,{onClick:y,variant:"secondary",icon:e.jsx(p,{size:16}),children:"Erneut versuchen"})]})})}):e.jsx(n.div,{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:e.jsx("div",{className:"p-4",children:i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mb-4",children:e.jsx(o,{size:24,className:"text-gray-400 dark:text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Keine Vertragsvorlagen gefunden"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 max-w-md mx-auto",children:"Erstellen Sie eine neue Vertragsvorlage, um loszulegen."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(t=>e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(o,{size:18,className:"text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t.title})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:t.is_active?"Aktiv":"Inaktiv"})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-1",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Kategorie"}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.category})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Version"}),e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.version||"Standard"," (v",t.version_number||1,")"]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded p-2 col-span-2",children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Zuletzt bearbeitet"}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.updated_at?Z(new Date(t.updated_at),{addSuffix:!0,locale:R}):"-"})]})]})}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-700/30 border-t border-gray-100 dark:border-gray-700 flex justify-end items-center",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>{k(t),x(!0)},className:"text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 flex items-center p-1.5",title:"Ansehen",children:e.jsx(M,{size:20})}),e.jsx("button",{onClick:()=>h(`/admin/contracts/${t.id}/edit`),className:"text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-indigo-400 flex items-center p-1.5",title:"Bearbeiten",children:e.jsx(K,{size:20})}),e.jsx("button",{onClick:()=>E(t),className:"text-gray-500 hover:text-amber-600 dark:text-gray-400 dark:hover:text-amber-400 flex items-center p-1.5",title:"Duplizieren",children:e.jsx(O,{size:20})}),e.jsx("button",{onClick:()=>F(t.id),className:"text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 flex items-center p-1.5",title:"Löschen",children:e.jsx($,{size:20})})]})})]},t.id))})})}),m&&e.jsx(P,{isOpen:v,onClose:()=>x(!1),contract:m,isAdmin:w()})]})},ae=A.memo(q);export{ae as default};
